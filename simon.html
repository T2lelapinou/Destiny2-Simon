<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Oracles - Mini Jeu</title>
<style>
  body {
    margin: 0;
    background-color: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  #game-container {
    position: relative;
    width: 1152px;
    height: 768px;
    background-image: url('https://i.imgur.com/r6zMibJ.png');
    background-size: cover;
    background-position: center;
    border: 2px solid #00ffff;
    border-radius: 10px;
  }

  .oracle {
    position: absolute;
    width: 40px;
    height: 40px;
    background-image: url('https://i.imgur.com/LOpNT5T.png');
    background-size: contain;
    background-repeat: no-repeat;
    opacity: 0.25;
    transition: opacity 0.3s ease;
    cursor: pointer;
  }

  .oracle.active {
    opacity: 1;
    filter: drop-shadow(0 0 15px #00ffff);
  }

  #info {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    color: #fff;
    font-family: sans-serif;
    background: rgba(0, 0, 0, 0.6);
    padding: 6px 15px;
    border-radius: 10px;
    font-size: 16px;
  }

  #play-btn {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(0, 255, 255, 0.15);
    border: 2px solid #00ffff;
    color: #00ffff;
    font-size: 24px;
    padding: 12px 25px;
    border-radius: 10px;
    cursor: pointer;
    font-family: sans-serif;
    transition: background-color 0.3s;
  }

  #play-btn:hover {
    background-color: rgba(0, 255, 255, 0.35);
  }
</style>
</head>
<body>
  <div id="game-container"></div>
  <div id="info">Clique sur ‚ÄúPlay‚Äù pour commencer</div>
  <button id="play-btn">‚ñ∂Ô∏è Lancer la s√©quence</button>

<script>
const gameContainer = document.getElementById('game-container');
const info = document.getElementById('info');
const playBtn = document.getElementById('play-btn');

// Coordonn√©es des 7 oracles (bas√©es sur ton plan)
const oraclePositions = [
  {x: 250, y: 270}, // Oracle 1 haut gauche
  {x: 110, y: 430}, // Oracle 2 milieu gauche
  {x: 180, y: 530}, // Oracle 3 bas gauche
  {x: 430, y: 500}, // Oracle 4 centre bas
  {x: 650, y: 430}, // Oracle 5 bas droite
  {x: 750, y: 310}, // Oracle 6 milieu droite
  {x: 650, y: 200}  // Oracle 7 haut droite
];

// Cr√©ation des oracles dans le DOM
const oracles = oraclePositions.map((pos, i) => {
  const el = document.createElement('div');
  el.classList.add('oracle');
  el.style.left = pos.x + 'px';
  el.style.top = pos.y + 'px';
  el.dataset.id = i;
  gameContainer.appendChild(el);
  return el;
});

// Sons placeholders √† remplacer par les tiens
const oracleSounds = [
  new Audio('https://files.catbox.moe/cbfdgl.mp3'),
  new Audio('https://files.catbox.moe/a7ggf7.mp3'),
  new Audio('https://files.catbox.moe/srlhts.mp3'),
  new Audio('https://files.catbox.moe/29dpk6.mp3'),
  new Audio('https://files.catbox.moe/xiibao.mp3'),
  new Audio('https://files.catbox.moe/13k4ej.mp3'),
  new Audio('https://files.catbox.moe/5ww6yw.mp3')
];

let sequence = [];
let playerInput = [];
let round = 3;
let playing = false;
let gameStarted = false;

// Fonction principale : lancement d'un tour
async function startRound() {
  playing = false;
  playerInput = [];
  sequence = generateSequence(round);
  info.textContent = `S√©quence de ${round} oracles...`;
  await playSequenceTwice(sequence);
  info.textContent = '√Ä ton tour !';
  playing = true;
}

// G√©n√©ration d'une s√©quence sans doublon
function generateSequence(length) {
  const available = [...Array(7).keys()];
  const seq = [];
  for (let i = 0; i < length; i++) {
    const randIndex = Math.floor(Math.random() * available.length);
    seq.push(available.splice(randIndex, 1)[0]);
  }
  return seq;
}

// Lecture de la s√©quence deux fois
async function playSequenceTwice(seq) {
  for (let repeat = 0; repeat < 2; repeat++) {
    for (const id of seq) {
      await highlightOracle(id);
      await wait(1000);
    }
    await wait(1500);
  }
}

// Animation + son
async function highlightOracle(id) {
  const el = oracles[id];
  el.classList.add('active');
  oracleSounds[id]?.play();
  await wait(700);
  el.classList.remove('active');
}

// Utilitaire d'attente
function wait(ms) {
  return new Promise(res => setTimeout(res, ms));
}

// Clics du joueur
oracles.forEach((oracle, index) => {
  oracle.addEventListener('click', () => {
    if (!playing) return;
    playerInput.push(index);
    highlightOracle(index);
    const expected = sequence[playerInput.length - 1];
    if (index !== expected) {
      info.textContent = '‚ùå Rat√© ! Reprise √† 3 oracles...';
      round = 3;
      setTimeout(startRound, 2000);
      playing = false;
    } else if (playerInput.length === sequence.length) {
      if (round === 7) {
        info.textContent = 'üèÜ Victoire ! S√©quence compl√®te !';
        playBtn.style.display = "block";
        playBtn.textContent = "üîÅ Rejouer";
      } else {
        info.textContent = '‚úÖ Bien jou√© ! Tour suivant...';
        round++;
        setTimeout(startRound, 2000);
      }
      playing = false;
    }
  });
});

// Clic sur le bouton "Play"
playBtn.addEventListener('click', () => {
  if (!gameStarted) gameStarted = true;
  playBtn.style.display = 'none';
  round = 3;
  startRound();
});
</script>
</body>
</html>
